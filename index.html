<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Chore Tracker">
<title>ü§ë Chore Tracker - Sandy & Rose</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü§ë</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Fredoka+One&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<style>
  body { margin: 0; padding: 0; }
  @keyframes floatBubble { 0% { transform: translateY(0) scale(1); } 100% { transform: translateY(-30px) scale(1.1); } }
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  @keyframes popIn { 0% { transform: scale(0.5); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
  @keyframes slideInRow { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }
  @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
  @keyframes savedPulse { 0% { opacity: 1; } 50% { opacity: 1; } 100% { opacity: 0; } }
  input::placeholder { color: #475569; }
  * { box-sizing: border-box; }
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const { useState, useEffect, useRef, useCallback } = React;

const DAYS = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"];
const PRICE_PER_CHORE = 0.16;
const STREAK_BONUS = 0.50;
const STORAGE_KEY = "choreTracker_v1";

const EMOJI_OPTIONS = ["‚≠ê", "üßπ", "üõèÔ∏è", "üçΩÔ∏è", "üóëÔ∏è", "üêæ", "üç¥", "‚ú®", "üëï", "üìö", "üé∏", "üå±", "üöø", "üßΩ", "üêï", "üêà", "üí™", "üéØ", "üß∏", "üé®", "üå∏", "ü¶Ñ", "ü¶´"];

const getWeekNumber = () => {
  const now = new Date();
  const start = new Date(now.getFullYear(), 0, 1);
  const diff = now - start;
  const oneWeek = 604800000;
  return Math.ceil(((diff / oneWeek) + start.getDay() + 1) / 1);
};

// localStorage helpers
const loadState = () => {
  try {
    const data = localStorage.getItem(STORAGE_KEY);
    if (data) return JSON.parse(data);
  } catch (e) {}
  return null;
};

const saveState = (completions, customChores) => {
  try {
    localStorage.setItem(STORAGE_KEY, JSON.stringify({
      completions,
      customChores,
      savedAt: new Date().toISOString(),
    }));
  } catch (e) {}
};

const TOILET_ROLL_SANDY = { id: 900, name: "Refill toilet rolls", emoji: "üßª", isShared: true };
const TOILET_ROLL_ROSE = { id: 901, name: "Refill toilet rolls", emoji: "üßª", isShared: true };
const BINS_SANDY = { id: 902, name: "Empty the bins", emoji: "üóëÔ∏è", isShared: true };
const BINS_ROSE = { id: 903, name: "Empty the bins", emoji: "üóëÔ∏è", isShared: true };

const BASE_CHORES = {
  sandy: [
    { id: 1, name: "Make my bed", emoji: "üõèÔ∏è" },
    { id: 2, name: "Tidy my room", emoji: "üßπ" },
    { id: 3, name: "Set the table", emoji: "üç¥" },
    { id: 4, name: "Empty the dishwasher", emoji: "üçΩÔ∏è", value: 0.40 },
  ],
  rose: [
    { id: 101, name: "Make my bed", emoji: "üõèÔ∏è" },
    { id: 102, name: "Tidy my room", emoji: "üßπ" },
    { id: 103, name: "Set the table", emoji: "üç¥" },
    { id: 104, name: "Empty the dishwasher", emoji: "üçΩÔ∏è", value: 0.4 },
  ],
};

const PROFILES = [
  { id: "sandy", name: "Sandy", avatar: "üå≠", age: 11, color: "#60a5fa", gradient: "linear-gradient(135deg, #3b82f6, #2563eb)", hasStreak: true },
  { id: "rose", name: "Rose", avatar: "ü¶´", age: 7, color: "#f472b6", gradient: "linear-gradient(135deg, #ec4899, #db2777)", hasStreak: true },
];

function ChoreTracker() {
  const saved = loadState();
  const [activeProfile, setActiveProfile] = useState("sandy");
  const [weekNum] = useState(getWeekNumber());
  const toiletRollTurn = weekNum % 2 === 0 ? "sandy" : "rose";

  const [completions, setCompletions] = useState(saved?.completions || { sandy: {}, rose: {} });
  const [customChores, setCustomChores] = useState(saved?.customChores || { sandy: [], rose: [] });
  const [showAddChore, setShowAddChore] = useState(false);
  const [newChore, setNewChore] = useState({ name: "", emoji: "‚≠ê" });
  const [selectedDay, setSelectedDay] = useState(null);
  const [animatingCell, setAnimatingCell] = useState(null);
  const [showCelebration, setShowCelebration] = useState(false);
  const [profileSwitchAnim, setProfileSwitchAnim] = useState(false);
  const [saveFlash, setSaveFlash] = useState(false);

  const profile = PROFILES.find((p) => p.id === activeProfile);

  const getChores = (pid) => {
    const base = [...BASE_CHORES[pid], ...customChores[pid]];
    if (pid === "sandy") {
      base.push(toiletRollTurn === "sandy" ? TOILET_ROLL_SANDY : BINS_SANDY);
    }
    if (pid === "rose") {
      base.push(toiletRollTurn === "rose" ? TOILET_ROLL_ROSE : BINS_ROSE);
    }
    return base;
  };

  const chores = getChores(activeProfile);
  const myCompletions = completions[activeProfile];

  useEffect(() => {
    const today = new Date().getDay();
    setSelectedDay(today === 0 ? 6 : today - 1);
  }, []);

  // Auto-save whenever state changes
  useEffect(() => {
    saveState(completions, customChores);
    setSaveFlash(true);
    const t = setTimeout(() => setSaveFlash(false), 1200);
    return () => clearTimeout(t);
  }, [completions, customChores]);

  const switchProfile = (id) => {
    if (id === activeProfile) return;
    setProfileSwitchAnim(true);
    setTimeout(() => {
      setActiveProfile(id);
      setShowAddChore(false);
      setProfileSwitchAnim(false);
    }, 200);
  };

  const toggleChore = (choreId, dayIndex) => {
    const key = `${choreId}-${dayIndex}`;
    setAnimatingCell(key);
    setTimeout(() => setAnimatingCell(null), 600);

    setCompletions((prev) => {
      const profileComps = { ...prev[activeProfile] };
      profileComps[key] = !profileComps[key];
      if (!profileComps[key]) delete profileComps[key];
      const next = { ...prev, [activeProfile]: profileComps };

      if (profile.hasStreak) {
        const oldStreak = calcStreak(prev[activeProfile], chores);
        const newStreak = calcStreak(next[activeProfile], chores);
        if (oldStreak < 7 && newStreak === 7) {
          setShowCelebration({ emoji: "üî•", label: "7-Day Streak!", sub: "+50p bonus!" });
          setTimeout(() => setShowCelebration(false), 2500);
        }
      }

      return next;
    });
  };

  const calcStreak = (comps, choreList) => {
    let streak = 0;
    for (let d = 0; d < 7; d++) {
      const hasDone = choreList.some((c) => comps[`${c.id}-${d}`]);
      if (hasDone) { streak++; } else { break; }
    }
    return streak;
  };

  const currentStreak = calcStreak(myCompletions, chores);

  const calcMoney = (comps) => Object.values(comps).filter(Boolean).length * PRICE_PER_CHORE;

  const calcStreakBonus = (comps, choreList) => calcStreak(comps, choreList) === 7 ? STREAK_BONUS : 0;

  const moneyEarned = calcMoney(myCompletions);
  const streakBonus = profile.hasStreak ? calcStreakBonus(myCompletions, chores) : 0;
  const totalMoney = moneyEarned + streakBonus;

  const totalDone = Object.values(myCompletions).filter(Boolean).length;
  const totalPossible = chores.reduce((sum, c) => sum + (c.isShared ? 1 : 7), 0);
  const maxMoney = totalPossible * PRICE_PER_CHORE + (profile.hasStreak ? STREAK_BONUS : 0);

  const getDayDone = (dayIndex) => chores.filter(c => myCompletions[`${c.id}-${dayIndex}`]).length;
  const getDayMoney = (dayIndex) => getDayDone(dayIndex) * PRICE_PER_CHORE;
  const getChoreCompletedDays = (choreId) => {
    let c = 0; for (let d = 0; d < 7; d++) { if (myCompletions[`${choreId}-${d}`]) c++; } return c;
  };

  const addChore = () => {
    if (!newChore.name.trim()) return;
    const allIds = [...getChores("sandy"), ...getChores("rose"), ...customChores.sandy, ...customChores.rose].map(c => c.id);
    const id = Math.max(0, ...allIds) + 1;
    setCustomChores((prev) => ({
      ...prev,
      [activeProfile]: [...prev[activeProfile], { id, name: newChore.name, emoji: newChore.emoji }],
    }));
    setNewChore({ name: "", emoji: "‚≠ê" });
    setShowAddChore(false);
  };

  const removeChore = (id) => {
    setCustomChores((prev) => ({
      ...prev,
      [activeProfile]: prev[activeProfile].filter((c) => c.id !== id),
    }));
    setCompletions((prev) => {
      const profileComps = { ...prev[activeProfile] };
      for (const key of Object.keys(profileComps)) {
        if (key.startsWith(`${id}-`)) delete profileComps[key];
      }
      return { ...prev, [activeProfile]: profileComps };
    });
  };

  const resetWeek = () => {
    if (confirm(`Clear ${profile.name}'s ticks for this week?`)) {
      setCompletions((prev) => ({ ...prev, [activeProfile]: {} }));
    }
  };

  const clearAll = () => {
    if (confirm("Clear ALL data for both Sandy and Rose on this device?")) {
      setCompletions({ sandy: {}, rose: {} });
      setCustomChores({ sandy: [], rose: [] });
      localStorage.removeItem(STORAGE_KEY);
    }
  };

  const otherProfile = PROFILES.find((p) => p.id !== activeProfile);
  const otherComps = completions[otherProfile.id];
  const otherChores = getChores(otherProfile.id);
  const otherMoney = calcMoney(otherComps) + (otherProfile.hasStreak ? calcStreakBonus(otherComps, otherChores) : 0);
  const toiletRollPerson = PROFILES.find((p) => p.id === toiletRollTurn);

  return (
    <div style={{
      minHeight: "100vh",
      background: "linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%)",
      fontFamily: "'Nunito', 'Quicksand', 'Segoe UI', sans-serif",
      padding: "20px", position: "relative", overflow: "hidden",
    }}>

      {/* Save indicator */}
      {saveFlash && (
        <div style={{
          position: "fixed", top: 12, right: 16, zIndex: 999,
          background: "rgba(52,211,153,0.9)", color: "white",
          padding: "5px 12px", borderRadius: 10, fontSize: 11, fontWeight: 700,
          animation: "savedPulse 1.2s ease forwards",
        }}>üíæ Saved</div>
      )}

      <div style={{ position: "fixed", inset: 0, pointerEvents: "none", zIndex: 0 }}>
        {[...Array(10)].map((_, i) => (
          <div key={i} style={{
            position: "absolute",
            width: `${40 + ((i * 17) % 60)}px`, height: `${40 + ((i * 23) % 60)}px`,
            borderRadius: "50%",
            background: [profile.color, "#fbbf24", "#34d399", "#f472b6", "#a78bfa", "#fb923c"][i % 6],
            opacity: 0.05, top: `${(i * 37) % 100}%`, left: `${(i * 43) % 100}%`,
            animation: `floatBubble ${8 + i * 2}s ease-in-out infinite alternate`,
          }} />
        ))}
      </div>

      {showCelebration && (
        <div style={{
          position: "fixed", inset: 0, zIndex: 1000,
          display: "flex", alignItems: "center", justifyContent: "center",
          background: "rgba(0,0,0,0.5)", backdropFilter: "blur(4px)", animation: "fadeIn 0.3s ease",
        }}>
          <div style={{
            background: "linear-gradient(135deg, #fbbf24, #f59e0b)",
            borderRadius: 24, padding: "40px 50px", textAlign: "center",
            animation: "popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)",
            boxShadow: "0 20px 60px rgba(251, 191, 36, 0.4)",
          }}>
            <div style={{ fontSize: 64, marginBottom: 12 }}>{showCelebration.emoji}</div>
            <div style={{ fontSize: 28, fontFamily: "'Fredoka One', cursive", color: "#1e293b" }}>{showCelebration.label}</div>
            <div style={{ fontSize: 18, color: "#92400e", marginTop: 8, fontWeight: 700 }}>{showCelebration.sub || ""}</div>
          </div>
        </div>
      )}

      <div style={{ maxWidth: 900, margin: "0 auto", position: "relative", zIndex: 1 }}>

        <div style={{ textAlign: "center", marginBottom: 20 }}>
          <h1 style={{
            fontFamily: "'Fredoka One', cursive", fontSize: "clamp(26px, 5vw, 40px)",
            background: `linear-gradient(135deg, ${profile.color}, #fbbf24, #f472b6)`,
            WebkitBackgroundClip: "text", WebkitTextFillColor: "transparent",
            margin: "0 0 4px 0", letterSpacing: 1,
          }}>ü§ë Chore Tracker</h1>
          <p style={{ color: "#94a3b8", fontSize: 14, margin: 0, fontWeight: 600 }}>
            Sandy & Rose's pocket money tracker üí∞
          </p>
        </div>

        {/* Shared jobs banner */}
        <div style={{
          background: "rgba(251, 191, 36, 0.08)", border: "1px solid rgba(251, 191, 36, 0.2)",
          borderRadius: 14, padding: "10px 18px", marginBottom: 16,
          display: "flex", alignItems: "center", justifyContent: "center", gap: 14,
          fontSize: 13, fontWeight: 700, color: "#fbbf24", flexWrap: "wrap",
        }}>
          <span>üßª Toilet rolls: <strong>{toiletRollPerson.name}</strong></span>
          <span style={{ color: "#475569" }}>|</span>
          <span>üóëÔ∏è Bins: <strong>{PROFILES.find(p => p.id !== toiletRollTurn).name}</strong></span>
          <span style={{ fontSize: 11, color: "#94a3b8", fontWeight: 600 }}>(swaps each week)</span>
        </div>

        {/* Profile switcher */}
        <div style={{ display: "flex", gap: 10, marginBottom: 20, justifyContent: "center" }}>
          {PROFILES.map((p) => {
            const isActive = p.id === activeProfile;
            const pComps = completions[p.id];
            const pChores = getChores(p.id);
            const pMoney = calcMoney(pComps) + (p.hasStreak ? calcStreakBonus(pComps, pChores) : 0);
            return (
              <button key={p.id} onClick={() => switchProfile(p.id)} style={{
                flex: "1 1 0", maxWidth: 220,
                background: isActive ? p.gradient : "rgba(255,255,255,0.04)",
                border: isActive ? "2px solid transparent" : "2px solid rgba(255,255,255,0.08)",
                borderRadius: 16, padding: "14px 18px", cursor: "pointer",
                transition: "all 0.3s ease",
                transform: isActive ? "scale(1.02)" : "scale(1)",
                boxShadow: isActive ? `0 8px 24px ${p.color}33` : "none",
              }}>
                <div style={{ fontSize: 32, marginBottom: 4 }}>{p.avatar}</div>
                <div style={{ fontSize: 15, fontWeight: 800, color: isActive ? "white" : "#94a3b8" }}>{p.name}</div>
                <div style={{ fontSize: 12, fontWeight: 700, marginTop: 2, color: isActive ? "rgba(255,255,255,0.8)" : "#64748b" }}>
                  Age {p.age} ¬∑ ¬£{pMoney.toFixed(2)}
                </div>
              </button>
            );
          })}
        </div>

        <div style={{
          opacity: profileSwitchAnim ? 0 : 1,
          transform: profileSwitchAnim ? "translateY(8px)" : "translateY(0)",
          transition: "all 0.2s ease",
        }}>

          {/* Earnings card */}
          <div style={{
            background: "linear-gradient(135deg, #1e293b, #334155)",
            borderRadius: 20, padding: "22px 26px", marginBottom: 18,
            border: `1px solid ${profile.color}33`, boxShadow: "0 8px 32px rgba(0,0,0,0.3)",
          }}>
            <div style={{ display: "flex", alignItems: "flex-start", justifyContent: "space-between", flexWrap: "wrap", gap: 14 }}>
              <div>
                <div style={{ color: "#94a3b8", fontSize: 12, fontWeight: 700, textTransform: "uppercase", letterSpacing: 1.5 }}>
                  {profile.name}'s earnings this week
                </div>
                <div style={{
                  fontFamily: "'Fredoka One', cursive", fontSize: "clamp(36px, 6vw, 52px)",
                  background: `linear-gradient(135deg, #fbbf24, ${profile.color})`,
                  WebkitBackgroundClip: "text", WebkitTextFillColor: "transparent",
                  lineHeight: 1.1, marginTop: 4,
                }}>¬£{totalMoney.toFixed(2)}</div>
                <div style={{ fontSize: 12, color: "#64748b", fontWeight: 600, marginTop: 6 }}>
                  {totalDone} chores √ó 16p = ¬£{moneyEarned.toFixed(2)}
                  {streakBonus > 0 && <span style={{ color: "#f59e0b" }}> + 50p streak bonus!</span>}
                </div>
                <div style={{ fontSize: 11, color: "#475569", fontWeight: 600, marginTop: 2 }}>
                  Max possible: ¬£{maxMoney.toFixed(2)}
                </div>
              </div>

              {profile.hasStreak && (
                <div style={{
                  background: currentStreak === 7 ? "linear-gradient(135deg, #f59e0b, #ef4444)" : "rgba(255,255,255,0.05)",
                  borderRadius: 16, padding: "14px 18px", textAlign: "center",
                  border: currentStreak > 0 ? "1px solid rgba(245, 158, 11, 0.3)" : "1px solid rgba(255,255,255,0.08)",
                  minWidth: 120,
                }}>
                  <div style={{ fontSize: 11, fontWeight: 800, color: currentStreak === 7 ? "#1e293b" : "#64748b", textTransform: "uppercase", letterSpacing: 1 }}>Streak</div>
                  <div style={{ display: "flex", gap: 4, justifyContent: "center", marginTop: 8 }}>
                    {DAYS.map((d, i) => (
                      <div key={i} style={{
                        width: 10, height: 10, borderRadius: "50%",
                        background: i < currentStreak ? "#f59e0b" : "rgba(255,255,255,0.1)",
                        boxShadow: i < currentStreak ? "0 0 6px rgba(245, 158, 11, 0.5)" : "none",
                        transition: "all 0.3s ease",
                      }} />
                    ))}
                  </div>
                  <div style={{ fontFamily: "'Fredoka One', cursive", fontSize: 22, color: currentStreak === 7 ? "#1e293b" : "#f59e0b", marginTop: 6, lineHeight: 1 }}>
                    {currentStreak}/7
                  </div>
                  <div style={{ fontSize: 9, fontWeight: 700, color: currentStreak === 7 ? "#1e293b" : "#64748b", marginTop: 4 }}>
                    {currentStreak === 7 ? "üî• BONUS +50p!" : currentStreak > 0 ? "üî• Keep going!" : "Do 1+ chore/day"}
                  </div>
                </div>
              )}
            </div>

            <div style={{ height: 8, borderRadius: 8, marginTop: 16, background: "rgba(255,255,255,0.08)", overflow: "hidden" }}>
              <div style={{
                height: "100%", borderRadius: 8,
                width: `${maxMoney > 0 ? Math.min(100, (totalMoney / maxMoney) * 100) : 0}%`,
                background: `linear-gradient(90deg, ${profile.color}, #fbbf24)`,
                transition: "width 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",
              }} />
            </div>
          </div>

          {/* Chore grid */}
          <div style={{
            background: "rgba(30, 41, 59, 0.8)", borderRadius: 20, overflow: "hidden",
            border: "1px solid rgba(255,255,255,0.08)", boxShadow: "0 8px 32px rgba(0,0,0,0.3)",
          }}>
            <div style={{
              display: "grid", gridTemplateColumns: "minmax(160px, 1.5fr) repeat(7, 1fr)",
              background: "rgba(0,0,0,0.2)", borderBottom: "1px solid rgba(255,255,255,0.06)",
            }}>
              <div style={{ padding: "12px 16px", fontSize: 11, fontWeight: 800, color: "#64748b", textTransform: "uppercase", letterSpacing: 1.5 }}>Chore</div>
              {DAYS.map((day, i) => {
                const isToday = selectedDay === i;
                return (
                  <div key={day} style={{
                    padding: "12px 0", textAlign: "center", fontSize: 11, fontWeight: 800,
                    textTransform: "uppercase", letterSpacing: 1,
                    color: isToday ? profile.color : "#64748b", position: "relative",
                  }}>
                    {day}
                    {isToday && <div style={{ position: "absolute", bottom: 0, left: "50%", transform: "translateX(-50%)", width: 18, height: 3, borderRadius: 3, background: profile.color }} />}
                  </div>
                );
              })}
            </div>

            {chores.map((chore, rowIndex) => {
              const daysCompleted = getChoreCompletedDays(chore.id);
              const maxDays = chore.isShared ? 1 : 7;
              const isCustom = customChores[activeProfile].some((c) => c.id === chore.id);
              return (
                <div key={chore.id} style={{
                  display: "grid", gridTemplateColumns: "minmax(160px, 1.5fr) repeat(7, 1fr)",
                  borderBottom: "1px solid rgba(255,255,255,0.04)",
                  background: chore.isShared ? "rgba(251, 191, 36, 0.03)" : "transparent",
                  animation: `slideInRow 0.3s ease ${rowIndex * 0.05}s both`,
                }}>
                  <div style={{ padding: "12px 16px", display: "flex", alignItems: "center", gap: 10, color: "#e2e8f0", fontSize: 13, fontWeight: 700 }}>
                    <span style={{ fontSize: 20 }}>{chore.emoji}</span>
                    <div style={{ flex: 1 }}>
                      <div style={{ lineHeight: 1.2, display: "flex", alignItems: "center", gap: 6 }}>
                        {chore.name}
                        {chore.isShared && (
                          <span style={{ fontSize: 8, fontWeight: 800, color: "#fbbf24", background: "rgba(251,191,36,0.15)", padding: "2px 6px", borderRadius: 6, textTransform: "uppercase" }}>my turn</span>
                        )}
                      </div>
                      <div style={{ fontSize: 10, color: "#64748b", fontWeight: 600, display: "flex", alignItems: "center", gap: 4 }}>
                        {daysCompleted}/{maxDays} ¬∑ ¬£{(daysCompleted * PRICE_PER_CHORE).toFixed(2)}
                        {isCustom && (
                          <button onClick={() => removeChore(chore.id)} style={{ background: "none", border: "none", cursor: "pointer", color: "#475569", fontSize: 11, padding: "0 3px" }}
                            onMouseEnter={e => e.target.style.color = "#ef4444"}
                            onMouseLeave={e => e.target.style.color = "#475569"}
                          >‚úï</button>
                        )}
                      </div>
                    </div>
                  </div>
                  {DAYS.map((_, dayIndex) => {
                    const key = `${chore.id}-${dayIndex}`;
                    const done = myCompletions[key];
                    const isAnimating = animatingCell === key;
                    const isToday = selectedDay === dayIndex;
                    const alreadyDoneElsewhere = chore.isShared && !done && DAYS.some((__, di) => di !== dayIndex && myCompletions[`${chore.id}-${di}`]);

                    return (
                      <div key={dayIndex} style={{
                        display: "flex", alignItems: "center", justifyContent: "center",
                        background: isToday ? `${profile.color}08` : "transparent",
                        cursor: alreadyDoneElsewhere ? "default" : "pointer",
                        opacity: alreadyDoneElsewhere ? 0.3 : 1,
                      }} onClick={() => !alreadyDoneElsewhere && toggleChore(chore.id, dayIndex)}>
                        <div style={{
                          width: 36, height: 36, borderRadius: 10,
                          display: "flex", alignItems: "center", justifyContent: "center",
                          background: done ? "linear-gradient(135deg, #34d399, #10b981)" : "rgba(255,255,255,0.05)",
                          border: done ? "none" : "1.5px solid rgba(255,255,255,0.1)",
                          transition: "all 0.2s ease",
                          transform: isAnimating ? "scale(1.3)" : "scale(1)",
                          boxShadow: done ? "0 4px 12px rgba(52, 211, 153, 0.3)" : "none",
                        }}>
                          {done && <span style={{ fontSize: 18, color: "white" }}>‚úì</span>}
                        </div>
                      </div>
                    );
                  })}
                </div>
              );
            })}

            <div style={{
              display: "grid", gridTemplateColumns: "minmax(160px, 1.5fr) repeat(7, 1fr)",
              background: "rgba(0,0,0,0.15)", borderTop: "1px solid rgba(255,255,255,0.06)",
            }}>
              <div style={{ padding: "11px 16px", fontSize: 11, fontWeight: 800, color: "#64748b", textTransform: "uppercase", letterSpacing: 1 }}>Daily ¬£</div>
              {DAYS.map((_, i) => {
                const dayMoney = getDayMoney(i);
                const dayDone = getDayDone(i);
                return (
                  <div key={i} style={{
                    padding: "11px 0", textAlign: "center", fontSize: 12, fontWeight: 800,
                    color: dayDone > 0 ? (dayDone === chores.length ? "#34d399" : "#fbbf24") : "#475569",
                  }}>{dayMoney > 0 ? `${(dayMoney * 100).toFixed(0)}p` : "‚Äì"}</div>
                );
              })}
            </div>
          </div>

          {/* Buttons */}
          <div style={{ display: "flex", gap: 10, marginTop: 14, flexWrap: "wrap" }}>
            <button onClick={() => setShowAddChore(!showAddChore)} style={{
              background: profile.gradient, color: "white", border: "none", borderRadius: 14,
              padding: "11px 20px", fontSize: 13, fontWeight: 800, cursor: "pointer",
              display: "flex", alignItems: "center", gap: 8, boxShadow: `0 4px 16px ${profile.color}44`,
            }}>‚ûï Add Chore</button>
            <button onClick={resetWeek} style={{
              background: "rgba(255,255,255,0.06)", color: "#94a3b8",
              border: "1px solid rgba(255,255,255,0.1)", borderRadius: 14,
              padding: "11px 20px", fontSize: 13, fontWeight: 700, cursor: "pointer",
            }}>üîÑ New Week</button>
            <button onClick={clearAll} style={{
              background: "rgba(239,68,68,0.1)", color: "#ef4444",
              border: "1px solid rgba(239,68,68,0.2)", borderRadius: 14,
              padding: "11px 20px", fontSize: 13, fontWeight: 700, cursor: "pointer",
            }}>üóëÔ∏è Clear All</button>
          </div>

          {showAddChore && (
            <div style={{
              background: "rgba(30, 41, 59, 0.95)", borderRadius: 20, padding: 22, marginTop: 12,
              border: `1px solid ${profile.color}44`, boxShadow: "0 8px 32px rgba(0,0,0,0.3)",
              animation: "slideDown 0.3s ease",
            }}>
              <div style={{ fontSize: 15, fontWeight: 800, color: "#e2e8f0", marginBottom: 14 }}>Add a new chore for {profile.name}</div>
              <div style={{ display: "flex", gap: 12, flexWrap: "wrap", alignItems: "flex-end" }}>
                <div style={{ flex: "1 1 160px" }}>
                  <label style={{ display: "block", fontSize: 11, fontWeight: 700, color: "#64748b", marginBottom: 5, textTransform: "uppercase", letterSpacing: 1 }}>Name</label>
                  <input type="text" value={newChore.name}
                    onChange={(e) => setNewChore({ ...newChore, name: e.target.value })}
                    placeholder="e.g. Walk the dog"
                    style={{ width: "100%", padding: "9px 13px", borderRadius: 10, background: "rgba(0,0,0,0.3)", border: "1px solid rgba(255,255,255,0.1)", color: "#e2e8f0", fontSize: 13, fontWeight: 600, outline: "none", boxSizing: "border-box" }}
                    onKeyDown={(e) => e.key === "Enter" && addChore()}
                  />
                </div>
                <div>
                  <label style={{ display: "block", fontSize: 11, fontWeight: 700, color: "#64748b", marginBottom: 5, textTransform: "uppercase", letterSpacing: 1 }}>Icon</label>
                  <div style={{ display: "flex", gap: 3, flexWrap: "wrap", maxWidth: 200 }}>
                    {EMOJI_OPTIONS.map((e) => (
                      <button key={e} onClick={() => setNewChore({ ...newChore, emoji: e })} style={{
                        width: 30, height: 30, borderRadius: 7, fontSize: 14,
                        border: newChore.emoji === e ? `2px solid ${profile.color}` : "1px solid rgba(255,255,255,0.1)",
                        background: newChore.emoji === e ? `${profile.color}33` : "rgba(0,0,0,0.2)",
                        cursor: "pointer", display: "flex", alignItems: "center", justifyContent: "center",
                      }}>{e}</button>
                    ))}
                  </div>
                </div>
                <button onClick={addChore} style={{
                  background: "linear-gradient(135deg, #34d399, #10b981)",
                  color: "#064e3b", border: "none", borderRadius: 12,
                  padding: "9px 18px", fontSize: 13, fontWeight: 800, cursor: "pointer",
                }}>Add ‚úì</button>
              </div>
            </div>
          )}

          {/* Stats */}
          <div style={{ display: "grid", gridTemplateColumns: "repeat(auto-fit, minmax(130px, 1fr))", gap: 10, marginTop: 18 }}>
            {[
              { label: "Earned", value: `¬£${totalMoney.toFixed(2)}`, color: "#fbbf24", emoji: "üí∞" },
              { label: "Chores Done", value: `${totalDone}/${totalPossible}`, color: "#34d399", emoji: "‚úÖ" },
              ...(profile.hasStreak ? [{ label: "Streak", value: `${currentStreak}/7 ${currentStreak === 7 ? "üî•" : ""}`, color: "#f59e0b", emoji: "‚ö°" }] : []),
              { label: otherProfile.name, value: `¬£${otherMoney.toFixed(2)}`, color: otherProfile.color, emoji: otherProfile.avatar },
            ].map((stat, i) => (
              <div key={i} style={{ background: "rgba(30, 41, 59, 0.8)", borderRadius: 14, padding: "14px 16px", border: "1px solid rgba(255,255,255,0.06)" }}>
                <div style={{ fontSize: 18, marginBottom: 4 }}>{stat.emoji}</div>
                <div style={{ fontSize: 10, fontWeight: 700, color: "#64748b", textTransform: "uppercase", letterSpacing: 1 }}>{stat.label}</div>
                <div style={{ fontSize: 16, fontWeight: 800, color: stat.color, marginTop: 3 }}>{stat.value}</div>
              </div>
            ))}
          </div>

          <div style={{ textAlign: "center", marginTop: 20, color: "#475569", fontSize: 11, fontWeight: 600 }}>
            Each chore = 16p{profile.hasStreak ? " ¬∑ 7-day streak = +50p bonus! üî•" : ""} ¬∑ Saves on this device üíæ
          </div>
        </div>
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<ChoreTracker />);
</script>
</body>
</html>
